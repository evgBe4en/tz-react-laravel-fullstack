# Calendar-app

### About

Додаток Календар являє собою базовий набір функцій, що відповідають назві програми..

Основні можливості:

- перегляд календаря
- додавання/редагування/видалення івентів на необхідний день
- фільтрація днів за івентами

## Вимоги для запуску проекту

PHP >= 8.1
Laravel >= 10
Composer >= 2.3.7
npm >= 8.5.1
MySQL
Локальный сервер по типу Wampp/Xampp та iн.

## Як запустити проект?

Запустiть локальный сервер.

Клонуйте сховище:

	 git clone 
 
Перейдіть до папки quiz-app:

 	 cd react-laravel-calendar

Створіть файл .env з файлу .env.example:

	cp .env.example .env
	
	або

	зробіть копію .env.example і назвіть її просто .env

Внесіть необхідні зміни конфігурації у файл .env:

	DB_CONNECTION=mysql
    DB_HOST=127.0.0.1
    DB_PORT=3306
    DB_DATABASE=calendar_db
    DB_USERNAME=root
    DB_PASSWORD=

Встановити Composer:

	composer install
	
Згенерувати ключ додатку:

	php artisan key:generate
	
Встановити Node.js залежності:

	npm install

Створити таблиці БД:

	php artisan migrate --seed

Запустити веб-сервер:

	php artisan serve

Запустити Vite у новому термiналi:

	npm run dev


# Back-end компоненти

## Моделi

- Event - 
	модель відповідає таблиці "Події" в БД. Забезпечує отримання і збереження подій та їх типів.

- Type - модель "Тип" призначена для роботи з відповідною таблицею в базі даних. Вона успадковує базовий клас Model та використовує HasFactory. Захищені тільки поля id та title. Реалізовано метод events, який через проміжну таблицю event_type забезпечує зв'язок many-to-many цієї моделі з моделлю Event, що дозволяє отримувати всі події кожного типу.

- TypeEvent - модель працює з проміжною таблицею "event_type". Вона дозволяє здійснювати many-to-many зв'язок між моделями "Подія" та "Тип".

## Роути

- api - Цей файл налаштовує API-запити до контролерів Подій та Типів, дозволяючи отримувати, додавати, оновлювати та видаляти їхні дані.

- web - Цей файл містить веб-маршрути для SPA-додатку. Він реєструє головний маршрут '/' який відображає компонент Calendar через бібліотеку Inertia.

## Запити

- валiдують вхiднi та вихiднi даннi

## Контроллери

- EventController: контролер відповідає за роботу з подіями:

		Метод index повертає колекцію подій, можливий фільтр за типом.

		Метод store створює нову подію користуючись сервісом.

		Метод update оновлює подію через сервіс.

		Метод delete видаляє подію за ідентифікатором.

	Використовуються валідаційні запити та ресурси.
	Конструктор ін'єктує сервіс для логіки додавання/оновлення.

Це дозволяє реалізувати CRUD-операції над подіями відповідно до стандартів REST API.

- TypeController: короткий контролер відповідає за отримання списку всіх типів.

		Метод index просто отримує всі записи з моделі Type та повертає їх у відповіді.

	Не використовує жодних додаткових сервісів чи параметрів, оскільки наразі потрібно лише отримати увесь список.

## Ресурси

- EventResource: 
		повертає масив де ключі - це назви полів моделі події.

		Для типу використовується вкладений ресурс TypeResource для серіалізації типу.

- TypeResource: повертає масив з полями id та title моделі типу.

Відносно EventResource:

		Використовується в якості вкладеного ресурсу для серіалізації зв'язаного типу

		Забезпечує уніфікований формат даних

## Сервiси

- EventStoreService: сервіс відповідає за логіку додавання та оновлення подій:

		Метод store створює подію, шукає/створює тип, формує зв'язок.

		Використовує транзакції для атомарності операцій.

		Метод update оновлює подію, знаходить/створює тип, встановлює зв'язок.

		Обидва методи обробляють помилки та повертають результат.

	Таким чином сервіс виконує логіку додавання та оновлення подій, а також типів та їх зв'язків для контролера. Це дозволяє відокремити бізнес-логіку від контролера.


## Миграции

- Events - 
		 id, name, description, date, location, time.
- Types - id, title
- EventType - міграція призначена для створення проміжної таблиці event_type для many-to-many зв'язку між events та types:

		Створюється таблиця з полями event_id та type_id.

		Додаються індекси для полів.

		Визначаються зовнішні ключі (foreign keys) для полів:

		event_id посилається на id в таблиці events
		type_id посилається на id в таблиці types

		Вказується cascade delete - при видаленні запису delete це прокаскадом видалить зв'язуючі записи.

Таким чином міграція налаштовує проміжну таблицю для many-to-many асоціації між events та types.

## Фабрики

- EventFactory: клас моделі Event як цільовий.

		Містить масиви попередньо заданих дат та часів.

		Метод definition генерує запис з фейковими даними:

		Ім'я події - фраза
		Опис - абзац
		Дата - випадкова з масиву
		Місце - випадкове місто
		Час - випадковий з масиву

- EventTypeFactory: цільовий клас EventType.

		Метод definition генерує записи з:

		Випадковим event_id від 1 до 10
		Випадковим type_id від 1 до 4
		Поточними датами створення/оновлення

- TypeFactory: цільовий клас Type.

		Містить масив типових значень для поля title.

		Метод definition:

		Генерує випадкове значення title з масиву

		Метод unique() у фейкера забезпечує унікальність значень

# Front-end компоненти

## Сторiнки

- Calendar -  компонент React, який відповідає за сторінку календаря

## Компоненти

- CreateEventForm: компонент реалізує форму додавання нової події:

		Використовує React hook form для роботи з формою
		За допомогою кастомного хука useFetchTypes отримує список типів з сервера
		Приймає функції onClose і обрану дату selected
		Записує дані форми в стейт за допомогою register
		Перевіряє валідацію за допомогою errors
		При submit робить POST запит на сервер
		Відображає loading/error стани
		Має кнопки скасування/додавання
- EditEventForm: компонент  для редагування події:

		Приймає на вході подію та колбеки з компоненту
		Ініціалізує дані форм з властивостей події
		За допомогою hook form реєструє поля та обробляє події
		Метод редагування робить PATCH запит на сервер із оновленими даними
		Додає кнопку видалення із DELETE запитом
		Використовує кастомний хук для вибору типів
		Обробляє loading/errors
- EventCard: компонент реалізує картку події:

		Приймає подію та колбек для закриття редактора
		Відображає основну інформацію про подію
		Додає клас типу в залежності від значення поля type
		Містить кнопку для відкриття форми редагування
		За допомогою стейту керує відображенням форми
- Filter: компонент відповідає за фільтрацію подій за типом.

		Приймає колбек для оновлення активних фільтрів
		Тримає стейт з кольорами активних кнопок
		Має кнопки для кожного типу
		Обробляє кліки - додає/видаляє кольори та значення фільтру
- Footer

		Звичайний footer сторiнки
- NavBar

		Звичайний NavBar сторiнки
- MonthList: компонент відповідає за відображення календаря:

		Рендерить два екземпляри DayPicker для подвійного календаря
		Кешує вибраний день, події на цей день
		Використовує кілька стейтів для керування відображенням компонентів
		Імпортує необхідні компоненти
		За допомогою хука фетчить події з сервера
- PopUp: компонент реалізує вікно підій на вибрану дату:

		Приймає події, дату, функції для відкриття форм
		Відображає заголовок та кнопку закриття
		Мапує масив подій, передаючи їх до EventCard
		Додає кнопку для створення нової події

## Хуки

- useFetchEvents: кастомний хук, який використовується для отримання подій з сервера:

		Використовує стейти і useEffect для фетчингу подій
		При ініціалізації робить GET запит на URL, передаючи параметри фільтрації
		Обробляє завантаження, помилки, отриманий результат
		Повертає стейти подій, стан завантаження і помилку

- useFetchTypes: кастомний React hook для отримання списку типів із сервера:

		Використовує стейти та useEffect
		Здійснює GET запит до ендпоінту /types
		В стейт записує отримані типи, а також стан завантаження/помилки
		Повертає ці стейти


### Бібліотеки та пакети проекту

- Laravel Breeze ( React )
- react-day-picker (l.v)
- axios (l.v)
- react-hook-form (l.v)

### Нереалiзованi функції

- стилiзацiя iвентiв, якi є на цей день

### Баги й недолiки

- якщо фабрика не створює в півот таблиці типи івентів на день і після натискання на день, у якого відсутній інвет тип, то сторінка крашиться

- було помилкою не юзати стейт менеджер
- дати й час

### P.S. Не баг, а фiча

- 2 компоненти <DayPicker/>
- css файл i назви стилiв
